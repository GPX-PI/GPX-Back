graph TB
    subgraph "🎨 Frontend - Next.js 14 App Router"
        subgraph "📱 Páginas Principales"
            HOME[🏠 / "HomePage"]
            CLASIF[📊 /clasificaciones]
            PROFILE[👤 /perfil]
            ADMIN[👨‍💼 /admin]
            LOGIN[🔐 /login]
            REGISTER[📝 /register]
            EVENTOS[🏁 /eventos]
            VEHICULOS[🚗 /vehiculos]
        end
        
        subgraph "🧩 Arquitectura de Componentes"
            subgraph "⚛️ Atoms"
                BTN[Button]
                INPUT[Input]
                CARD[Card]
                BADGE[Badge]
                TABLE[Table]
                SELECT[Select]
                DIALOG[Dialog]
            end
            
            subgraph "🔷 Molecules"
                FORM[Forms]
                NAVBAR[Navbar]
                SIDEBAR[Sidebar]
                LOADING[LoadingStates]
                TOAST[Toast]
            end
            
            subgraph "🏗️ Organisms"
                DASHBOARD[AdminDashboard]
                EVENTS_MGMT[EventsManagement]
                USERS_MGMT[UsersManagement]
                CATEGORIES_MGMT[CategoriesManagement]
                STAGE_RESULTS_MGMT[StageResultsManagement]
                PROFILE_FORM[ProfileForm]
                CLASIF_TABLE[ClasificacionTable]
            end
        end
        
        subgraph "🔧 Frontend Services"
            AUTH_CONTEXT[🔑 AuthContext]
            AUTH_UTILS[🔧 auth.utils.ts]
            AUTH_FETCH[📡 authFetch.ts]
            OAUTH_HANDLER[🌐 useOAuth2Handler]
            STORAGE[💾 Storage Utils]
        end
        
        subgraph "🎨 Styling & UI"
            TAILWIND[🎨 Tailwind CSS]
            SHADCN[🎯 shadcn/ui]
        end
    end
    
    subgraph "🔐 Security & Authentication Layer"
        JWT[🔑 JWT Authentication]
        SPRING_SEC[🛡️ Spring Security]
        OAUTH2[🌐 Google OAuth2]
        AUTH_GUARD[🛡️ Authentication Guards]
        ADMIN_GUARD[👑 Admin Guards]
    end
    
    subgraph "🌐 Backend API - Spring Boot"
        subgraph "🔐 Endpoints de Autenticación"
            AUTH_LOGIN[POST /api/users/login]
            AUTH_REGISTER[POST /api/users/simple-register]
            AUTH_OAUTH_URL[GET /api/users/oauth2/login-url]
            AUTH_SUCCESS[GET /api/oauth2/success]
            AUTH_STATUS[GET /api/oauth2/profile-status]
        end
        
        subgraph "👥 Endpoints de Usuarios"
            USER_LIST[GET /api/users "Admin"]
            USER_GET[GET /api/users/:id "Owner/Admin"]
            USER_UPDATE[PUT /api/users/:id "Owner/Admin"]
            USER_ADMIN[PATCH /api/users/:id/admin "Admin"]
            USER_COMPLETE[POST /api/users/:id/complete-profile]
            USER_PICTURE[PUT /api/users/:id/profile-picture]
            USER_CHECK[GET /api/users/check-email]
        end
        
        subgraph "🚗 Endpoints de Vehículos"
            VEHICLE_LIST[GET /api/vehicles "Admin"]
            VEHICLE_USER[GET /api/vehicles/user/:userId]
            VEHICLE_CREATE[POST /api/vehicles]
            VEHICLE_UPDATE[PUT /api/vehicles/:id "Owner/Admin"]
            VEHICLE_DELETE[DELETE /api/vehicles/:id "Owner/Admin"]
        end
        
        subgraph "🏁 Endpoints de Eventos"
            EVENT_LIST[GET /api/events]
            EVENT_CREATE[POST /api/events "Admin"]
            EVENT_UPDATE[PUT /api/events/:id "Admin"]
            EVENT_DELETE[DELETE /api/events/:id "Admin"]
        end
        
        subgraph "📍 Endpoints de Etapas"
            STAGE_LIST[GET /api/stages]
            STAGE_CREATE[POST /api/stages "Admin"]
            STAGE_UPDATE[PUT /api/stages/:id "Admin"]
            STAGE_DELETE[DELETE /api/stages/:id "Admin"]
        end
        
        subgraph "🎯 Endpoints de Categorías"
            CATEGORY_LIST[GET /api/categories]
            CATEGORY_CREATE[POST /api/categories "Admin"]
            CATEGORY_UPDATE[PUT /api/categories/:id "Admin"]
            CATEGORY_DELETE[DELETE /api/categories/:id "Admin"]
        end
        
        subgraph "📊 Endpoints de Resultados"
            RESULT_LIST[GET /api/stageresults]
            RESULT_CREATE[POST /api/stageresults "Admin"]
            RESULT_UPDATE[PUT /api/stageresults/:id "Admin"]
            RESULT_DELETE[DELETE /api/stageresults/:id "Admin"]
        end
    end
    
    subgraph "🏗️ Backend Architecture"
        subgraph "🎮 Controller Layer"
            UC[UserController]
            VC[VehicleController]
            EC[EventController]
            SC[StageController]
            SRC[StageResultController]
            EVC[EventVehicleController]
            ECC[EventCategoryController]
            CC[CategoryController]
        end
        
        subgraph "⚙️ Service Layer"
            US[UserService]
            VS[VehicleService]
            ES[EventService]
            SS[StageService]
            SRS[StageResultService]
            EVS[EventVehicleService]
            ECS[EventCategoryService]
            CS[CategoryService]
        end
        
        subgraph "📦 DTOs & Models"
            CDTO[CreateStageResultDTO]
            UDTO[UpdateStageResultDTO]
            PDTO[ParticipantDTO]
            CLDTO[ClasificacionDTO]
            USER_MODEL[User Entity]
            VEHICLE_MODEL[Vehicle Entity]
            EVENT_MODEL[Event Entity]
        end
    end
    
    subgraph "🗄️ Data Layer"
        DB[(PostgreSQL Database)]
        REPOSITORIES[JPA Repositories]
    end
    
    subgraph "🌐 External Services"
        GOOGLE_OAUTH[Google OAuth2 API]
        FILE_STORAGE[File Storage System]
    end
    
    %% Flujo Frontend a Backend
    HOME --> AUTH_FETCH
    ADMIN --> AUTH_GUARD
    PROFILE --> AUTH_CONTEXT
    LOGIN --> AUTH_LOGIN
    REGISTER --> AUTH_REGISTER
    
    %% Autenticación
    AUTH_FETCH --> JWT
    AUTH_GUARD --> SPRING_SEC
    AUTH_CONTEXT --> OAUTH2
    
    %% API Calls
    AUTH_FETCH --> USER_LIST
    AUTH_FETCH --> VEHICLE_LIST
    AUTH_FETCH --> EVENT_LIST
    AUTH_FETCH --> STAGE_LIST
    AUTH_FETCH --> CATEGORY_LIST
    AUTH_FETCH --> RESULT_LIST
    
    %% Backend Flow
    USER_LIST --> UC
    VEHICLE_LIST --> VC
    EVENT_LIST --> EC
    STAGE_LIST --> SC
    CATEGORY_LIST --> CC
    RESULT_LIST --> SRC
    
    UC --> US
    VC --> VS
    EC --> ES
    SC --> SS
    CC --> CS
    SRC --> SRS
    
    US --> REPOSITORIES
    VS --> REPOSITORIES
    ES --> REPOSITORIES
    SS --> REPOSITORIES
    CS --> REPOSITORIES
    SRS --> REPOSITORIES
    
    REPOSITORIES --> DB
    
    %% External Services
    OAUTH2 --> GOOGLE_OAUTH
    USER_PICTURE --> FILE_STORAGE
    
    %% Estilos
    classDef frontend fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    classDef backend fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef security fill:#fff8e1,stroke:#ff8f00,stroke-width:2px
    classDef data fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
    classDef external fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    
    class HOME,CLASIF,PROFILE,ADMIN,LOGIN,REGISTER,EVENTOS,VEHICULOS,BTN,INPUT,CARD,BADGE,TABLE,SELECT,DIALOG,FORM,NAVBAR,SIDEBAR,LOADING,TOAST,DASHBOARD,EVENTS_MGMT,USERS_MGMT,CATEGORIES_MGMT,STAGE_RESULTS_MGMT,PROFILE_FORM,CLASIF_TABLE,AUTH_CONTEXT,AUTH_UTILS,AUTH_FETCH,OAUTH_HANDLER,STORAGE,TAILWIND,SHADCN frontend
    
    class AUTH_LOGIN,AUTH_REGISTER,AUTH_OAUTH_URL,AUTH_SUCCESS,AUTH_STATUS,USER_LIST,USER_GET,USER_UPDATE,USER_ADMIN,USER_COMPLETE,USER_PICTURE,USER_CHECK,VEHICLE_LIST,VEHICLE_USER,VEHICLE_CREATE,VEHICLE_UPDATE,VEHICLE_DELETE,EVENT_LIST,EVENT_CREATE,EVENT_UPDATE,EVENT_DELETE,STAGE_LIST,STAGE_CREATE,STAGE_UPDATE,STAGE_DELETE,CATEGORY_LIST,CATEGORY_CREATE,CATEGORY_UPDATE,CATEGORY_DELETE,RESULT_LIST,RESULT_CREATE,RESULT_UPDATE,RESULT_DELETE,UC,VC,EC,SC,SRC,EVC,ECC,CC,US,VS,ES,SS,SRS,EVS,ECS,CS,CDTO,UDTO,PDTO,CLDTO,USER_MODEL,VEHICLE_MODEL,EVENT_MODEL backend
    
    class JWT,SPRING_SEC,OAUTH2,AUTH_GUARD,ADMIN_GUARD security
    
    class DB,REPOSITORIES data
    
    class GOOGLE_OAUTH,FILE_STORAGE external
